(load "data/articles.lisp")

;; common-lisp don't have a replace string function natively
(defun replace-all (string part replacement &key (test #'char=))
  (with-output-to-string (out)
			 (loop with part-length = (length part)
			       for old-pos = 0 then (+ pos part-length)
			       for pos = (search part string
						 :start2 old-pos
						 :test test)
			       do (write-string string out
						:start old-pos
						:end (or pos (length string)))
			       when pos do (write-string replacement out)
			       while pos)))

;; common-lisp don't have a split string function natively
;; thanks https://gist.github.com/siguremon/1174988
(defun split-str-1 (string &optional (separator " ") (r nil))
  (let ((n (position separator string
		     :from-end t
		     :test #'(lambda (x y)
			       (find y x :test #'string=)))))
    (if n
	(split-str-1 (subseq string 0 n) separator (cons (subseq string (1+ n)) r))
            (cons string r))))
(defun split-str (string &optional (separator " "))
  (split-str-1 string separator))

;; we have to remove the quotes
;; when using collect in a loop
(defun strip-quotes(input)
  (format nil "濑轭瘐舂换祜徜骈戾狍篝蜷铉换麇弩汜疱麸狯镩驷殪躜弩鏖翳骘蝽狒ㄤ彐躅祜徜骈戾疳翳蝈痨徙瀛犰篝蜷瓠聃雉弩鏖翳镳孱骈戾篝蝈犴疳翳祜镳骘扉铄蝈徜扉铄篝蝈犴铋飑麒殪扉铄泔祆邈扉铄┅┅换筢鲥篝蜷铉轭骈戾ㄤ彐躅筢鲥骈戾疳翳溽翎鏖翳镳孱骈戾篝蝈犴ㄣ镱汜翦钺翦篝蜷铉秕麴豸疳翳轰轵邈糸镱猴豸瘐洪姝屮轶趔后躔弪箦溴ㄦ矧磲篝蝈犴溽翎┅换箝眇扉纟翳篝蝈痨徙黠螂ㄤ彐磲泸翦眇灬翦ㄢ彐矧怙澌徭翦颟啜痱镧箦翩秕麴豸蝈痨徙瀛犰秕麴豸忮骘蝈泪骠弪┅┅换箝眇扉纟翳溴沆狎狒轱镦铄疳珏豉疱ㄤ彐磲泸痱屦狎濞翦眇灬翦怙澌泔溴啜痱镧戾è秕麴豸祜徜骈戾翦眇灬翦┅楞镤秕麴豸┅换箝眇扉纟翳骈戾筢鲩铉怡躞轭翳灬秕ㄤ彐磲泸珏铄蜥翦钺礤怙澌溽翎啜痱镧筢鲥骈戾钺礤ㄧ孱弪狒瀛灬秕冷狒岍┅换珏铄蜥翦翳扉篝镦翎珞ㄤ彐躅狎糸沆弩怡翎绋戾è翎绛扉篝┅祜镳骘狎糸沆轭狎糸沆弩滹ㄩㄧ弭狎糸沆呼徵铋飑换麇滹瞌麽铘犷弪蝻殒铒翎祜镳骘翎轭箴扉舡篝ㄧ弭狎糸沆呼徵┅滹换骘遽汨黠蜾轭翎脲黠蜾箦翩ㄧ弭翎绛扉篝ㄩ铘弪翎⑺刨紫夷┅换麇泸遽翦翳脲黠蜾轶轭屮轶翦铘犷徜赡麸忽犰蹂扉篝侯犴翎忽犰蹂瘐箬ㄧ弭狎糸沆洪洎ㄧ弭ㄧ弭翎绛扉篝ㄩ铘弪翎⑺刨紫夷┅忽犰蹂┅┅┅祜镳骘骝镯麸戾铉翳翎绛扉篝怡泔祆邈换蝈盹鲩铉翳脲黠蜾铘翎绛扉篝┅┅换珏铄蜥翦翳梏盱镦翳扉篝镦翎珞骘犷狎糸沆ㄤ彐躅珏舡翎绛扉篝狎糸沆濞镳糸镱犰狎糸沆濠篝蜷瓠聃雉弩磲疸狎＇灬礅溽ㄩ翦愆痱屦狎Ⅳ屙痨狒瀵镱瀛翎绠麴膦翦眇灬翦ゥ吾礤ゥ轸屙┅箴扉舡篝ㄧ弭狎糸沆呼徵┅┅换珏铄蜥翦翳梏盱镦翳麒镬扉篝镦翎珞ㄤ彐躅珏舡翎绛扉篝ī篝蜷瓠聃雉弩磲疸狎＇灬礅溽ㄩ翦愆痱屦狎Ⅳ屙痨狒瀵镱瀛翎绠麴膦翦眇灬翦ゥ吾礤ゥㄧ弭轸屙侯犴濠┅ㄡ螋殂戾蟓怡翎绌┅换珏铄蜥翦翳梏盱镦镱镱禊狎糸沆换翳轶轶汜祆邃轭祜镳麸痱镤蹉翳栾礤疳珏ㄤ彐躅泸遽翦狎糸沆濞狎糸沆镳糸镱犰脲糸铢舂痱屦狎Ⅳ屙痨狒瀵狎糸沆瀹麴膦翦眇灬翦ゥ刘翳矧ゥㄧ弭狎糸沆横豸栾ㄧ弭泔铈殓瑚邂磲篝弪┅翦眇灬翦ゥ尼翦ゥㄧ弭狎糸沆轰狒濠翦眇灬翦ゥ蚤綮濂アㄧ弭狎糸沆呼轸戾┅翦眇灬翦ゥ射ゥㄧ弭狎糸沆洪洎翦眇灬翦ゥ葬珞ゥㄧ弭翎绛扉篝狎糸沆狎糸沆濠翦眇灬翦ゥ藻籁アㄩㄡ钿糸铢礤礅弪呼轭狎糸沆濠ㄧ弭狎糸沆呼轭祜徜骈戾ㄦ矧磲铋溽翎洚豇簪ㄧ弭狎糸沆洪洎┅┅┅换蝈趱蝾梏盱篝蜷铉换痱镤蹉翳泔溴镦麒镬疳珏鏖翳糸綮瀚灬秕鏖翳翳疳蜥礤翦狍翳泔铘孱ㄤ彐躅珏铄蜥翦灬秕舁怙澌痱屦狎Ⅳ屙痨狒瀵灬秕舢麴膦翦眇灬翦ゥ蚤綮濂アㄧ弭泔铈殓呼轸戾┅翦眇灬翦ゥ葬珞ゥㄧ弭翎绛扉篝┅翦眇灬翦ゥ嘛澌ゥ怙澌秕麴豸┅换梏盱珏铄蜥糸镱镦轭溴栾礤疳珏ㄤ彐躅珏铄蜥翦箦黹磲轭疳珏ī篝蜷瓠聃雉弩祜镳骘狎糸沆轭狎糸沆弩泔祆邈ㄣ蝈狒瀛狎糸沆狎糸沆呼轭舂┅换梏盱珏铄蜥糸镱镦翎栾礤疳珏ㄤ彐躅珏铄蜥翦翎绛磲轭疳珏ㄡ螋殂戾蟓轭翎绌篝蜷瓠聃雉弩祜镳骘狎糸沆轭狎糸沆弩麒孱礤礅弪ㄧ弭狎糸沆洪洎狎糸沆弩轭翎呼弩＇羼踽飑泔祆邈ㄣ蝈狒瀛狎糸沆狎糸沆呼轭舂┅换盱珏铄蜥糸镱镦翳轸屙骘翳蝮ㄤ彐躅珏铄蜥翦蝮蟓轸屙ī篝蜷瓠聃雉弩祜镳骘狎糸沆轭狎糸沆弩泔祆邈痱屦狎Ⅳ屙痨狒瀵蝮蟓轸屙麴膦翦眇灬翦ゥ蚤綮濂アㄧ弭狎糸沆呼轸戾┅翦眇灬翦ゥ腻筱蜷痿轱睽アㄧ弭狎糸沆后栾螋┅翦眇灬翦ゥ镇欹アㄦ矧磲铋浏狎糸沆瀛洚梏盱ㄧ弭泔铈殓乎蜢ㄧ弭狎糸沆洪洎┅┅┅换清铄蜥翦翳蝮盱溽翎ㄤ彐躅珏铄蜥翦蝮蟥痱屦狎Ⅳ屙痨狒瀵蝮螽麴膦翦眇灬翦ゥ腻筱蜷痿轱睽アㄧ弭泔铈殓轰弩泸轲糸镱┅翦眇灬翦ゥ蚤綮濂アㄧ弭泔铈殓呼轸戾┅翦眇灬翦ゥ镇欹アㄧ弭泔铈殓乎蜢┅翦眇灬翦ゥ婶屙螗アㄧ孱弪狒瀛蝮蟓轸屙┅┅换盼巧闻釉烈换澡轶轶骢钽糸镱汜祆邃麒孱蝓铑轭翳麸镬ㄤ彐躅珏铄蜥翦箝翦ī换痱镤蹉轭溴梏盱ㄧ孱弪狒㈤钿屮梏盱ㄧ孱弪狒瀛箦黹磲轭疳珏┅换痱镤蹉遽汨狎糸沆骈戾ㄤ镬轶ㄡ螋殂戾狎糸沆弩ㄧ孱弪狒ㄦ矧磲铋⑨螋殂戾洚梏盱ㄧ弭狎糸沆洪洎ㄣ蝈狒瀛狎糸沆狎糸沆呼轭铋飑┅换痱镤蹉轭溴骈戾骘遽汨翎祜镳骘翎轭ㄡ螋殂戾蟓怡翎绌滹ㄧ孱弪狒ㄦ矧磲铋膦翎绛洚梏盱ㄧ弭翎何镣农ㄧ孱弪狒瀛翎绛磲轭疳珏ㄧ弭翎褐撂张┅┅换ㄧ孱弪狒瀛骈戾蝮螬筢鲥骈戾Ⅱ篌盱ㄧ孱弪狒瀛蝮螬ㄧ孱弪狒瀛箝翦ㄥ轸